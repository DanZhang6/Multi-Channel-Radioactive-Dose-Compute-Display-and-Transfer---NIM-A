C51 COMPILER V9.60.7.0   TIME0                                                             08/16/2023 22:48:38 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE TIME0
OBJECT MODULE PLACED IN .\Objects\time0.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE time0.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\tim
                    -e0.lst) TABS(2) OBJECT(.\Objects\time0.obj)

line level    source

   1          /************************************************************
   2          *ÃèÊö£º
   3          *     ¶¨Ê±Æ÷0ÉèÖÃ
   4          *¹¦ÄÜ£º
   5          *     ¶¨Ê±Æ÷0¹¤×÷ÔÚ·½Ê½1£¬Ã¿5msÖÐ¶ÏÒ»´Î£¬¶¨Ê±Æ÷Ò»Ö±¿ª×Å
   6          
   7          ***********************************************************/
   8          #include "STC15F2K60S2.h"
   9          #include "intrins.h"
  10          #include "config.h"
  11          #include "absacc.h"
  12          uint NumT0;                                //8253¶¨Ê±ÖÐ¶Ï´ÎÊý,ÔÚ°´ÏÂ²âÁ¿°´¼üºó³õÊ¼»¯Îª0;
  13          uint CntFlhWarnT0;                         //Ö÷»ú²É¼¯Êý¾ÝÊ±µÆÉÁË¸¶¨Ê±ÖÐ¶Ï´ÎÊý
  14          uint CntWarn;                              //LEDµÆÉÁË¸¶¨Ê±ÖÐ¶Ï´ÎÊý
  15          uint CntS1Warn;                            //±¸ÓÃÏÔÊ¾ÆÁÉÏµÆÉÁË¸¶¨Ê±ÖÐ¶Ï´ÎÊý
  16          uint CmOverTime;                           //Ö÷´Ó»úÍ¨ÐÅÎÕÊÖ¶¨Ê±ÖÐ¶Ï´ÎÊý
  17          bit Flag_Warn_Serial1;                     //±¸ÓÃÏÔÊ¾µÆ¶¨Ê±½áÊø±êÊ¶
  18          bit Flag_Tim0;                             //¶¨Ê±Æ÷0½áÊø±êÖ¾£¬Ä¬ÈÏ0£»
  19          bit FlagCollFall;                          //Ö÷´ÓÍ¨ÐÅÊ§°Ü±êÖ¾£¬0
  20          /*************************************
  21          *         ¶¨Ê±Æ÷0ÖÐ¶Ï³ÌÐò
  22          **************************************/
  23          void Tim0(void) interrupt 1                 //tim0¶¨Ê±½áÊøºóÔËÐÐÖÕ¶Ë³ÌÐò(¶¨Ê±ÖÐ¶Ï)
  24          {
  25   1        TF0=0;                                    //ÉèÖÃ¶¨Ê±Æ÷¿ØÖÆ¶¨Ê±Æ÷,ÖØÖÃ¶¨Ê±Æ÷³õÖµ
  26   1          TH0=0xDC;                                 //¶¨Ê±Æ÷0Ã¿5msÖÐ¶ÏÒ»´Î
  27   1          TL0=0x00;
  28   1        if(Flag_Mast)                             //ÈôÖ÷´Ó»ú°´Å¥ÎªÖ÷»ú
  29   1        {
  30   2            if(FlagMasColSlavOK)                    //Ö÷»ú²É¼¯Êý¾ÝÊ±µÆÉÁË¸¶¨Ê±
  31   2            {
  32   3                if(++CntFlhWarnT0 >= TimeFiveHundred) //TimeFiveHundred=100,¶¨Ê±Æ÷5msÖÐ¶ÏÒ»´Î,±¨¾¯µÆÔò500msË¢ÐÂÒ»´
             -Î
  33   3                {
  34   4                  CntFlhWarnT0 = 0;
  35   4                  Flag_Warn_Led = 1;                  //µÆ×´Ì¬¿ªÊ¼±ä»»±êÖ¾
  36   4                }
  37   3            }
  38   2          }
  39   1          if(Flag_Warn_Count)                       //°´¼ü²âÁ¿Ê±µÆÉÁË¸¶¨Ê±
  40   1          {
  41   2            if(++CntWarn >= TimeFiveHundred)        //500msË¢ÐÂÒ»´Î
  42   2            {
  43   3                CntWarn = 0;
  44   3                Flag_Warn_Flash = 1;                  //µÆ×´Ì¬¿ªÊ¼±ä»»±êÖ¾
  45   3            }
  46   2          }
  47   1        if(Flag8253Cnting)              //8253¼ÆÊý¶¨Ê±¿ªÊ¼±êÖ¾ÖÐ¶Ï,°´ÏÂ²âÁ¿°´¼üºó=1 ¿ªÊ¼¶¨Ê±
  48   1        {
  49   2          if(NumT0==0)
  50   2          {
  51   3            GATE=1;
  52   3          }
  53   2            NumT0 = ++NumT0;
C51 COMPILER V9.60.7.0   TIME0                                                             08/16/2023 22:48:38 PAGE 2   

  54   2          if(NumT0==100)            //¼ÆÊýÆÚ¼ä¸øÒ»¸öÂö³å¸ø¼ÆÊýÆ÷£¬·ÀÖ¹¼ÆÊýÆ÷¼ÆÊý²»¸üÐÂ
  55   2          {
  56   3            OE_573=0;
  57   3            IN_573=0;
  58   3            IN_573=1;
  59   3            OE_573=1;
  60   3          }
  61   2          if(NumT0 >=(200*Refresh_Time))         //AA1*,1SÖÓÖÐ¶Ï200´Î£¬RedrawtimeÊ±¼äÄÚÖÐ¶Ï200*Redrawtime´Î,¼´ÖÐ¶Ï1Ãë
             -ºóÖ´ÐÐ,¹Ø±Õ8253ÃÅ¿ØÐÅºÅ
  62   2          {
  63   3            GATE = 0;               //¹Ø±Õ8253ÃÅ¿ØÐÅºÅ
  64   3            NumT0 = 0;
  65   3            Flag_Tim0 = 1;              //¼ÆÊ±Æ÷½áÊø±êÖ¾£¬ÔÚmainº¯ÊýÖÐ²»¶Ï¼ì²âÊÇ·ñÎª1£¬ÎªÒ»Ê±½øÈëÑ­»·
  66   3            Flag8253Cnting = 0;           //¶¨Ê±¼ÆÊý±êÖ¾ÇåÁã
  67   3          }
  68   2        }
  69   1        if(FlagColling)                           //Êý¾Ý²É¼¯¼ä¸ôÊ±¼ä¶¨Ê±
  70   1        {
  71   2          if(++CntColTimer >= TimeOneHundred)     //100msË¢ÐÂÒ»´Î
  72   2          {
  73   3            FlagCollErr = 1;
  74   3            CntColTimer = 0;
  75   3          }
  76   2        }
  77   1        if(Flag_Collateral)                       //Ö÷´Ó»úÍ¨ÐÅÎÕÊÖ¶¨Ê±
  78   1        {
  79   2          if(++CmOverTime >=TimeThreeThousand)
  80   2          {
  81   3            FlagCollFall = 1;
  82   3            CmOverTime = 0;
  83   3          }
  84   2        }
  85   1      }
  86          
  87          /*************************************
  88          *         ¶¨Ê±Æ÷0³õÊ¼»¯
  89          **************************************/
  90          void Init_Time0()
  91          {
  92   1        TMOD=0x01;                  //¶¨Ê±Æ÷0¹¤×÷ÔÚ·½Ê½1
  93   1        TH0=0xDC;                   //Ô¤ÖÃ¶¨Ê±³õÖµDC00H,¾§ÕñÆµÂÊ22.1184MHz,¶¨Ê±Ê±³¤Ô¼5ms
  94   1        TL0=0x00;
  95   1        NumT0=0;                    //ÖÐ¶Ï¼ÆÊý³õÊ¼»¯
  96   1        CntFlhWarnT0 = 0;
  97   1        CntWarn = 0;
  98   1        CntS1Warn = 0;
  99   1        CmOverTime = 0;
 100   1        CntColTimer = 0;
 101   1        EA=1;                       //¿ªÆô×ÜÖÐ¶Ï
 102   1        ET0=1;                      //¿ªÆô¶¨Ê±Æ÷0Ê¹ÄÜ
 103   1        TR0=1;                    //¿ªÆô¶¨Ê±Æ÷0
 104   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    250    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3    ----
C51 COMPILER V9.60.7.0   TIME0                                                             08/16/2023 22:48:38 PAGE 3   

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
